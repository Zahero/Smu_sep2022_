Sub booth_stock()          'init variable to hold sum    Dim total_volume As Double        ' Set an initial variable for holding the stock name and row    Dim stockName As String    Dim i As Double        'yearly change     Dim openingPrice As Double     Dim closingPrice As Double     Dim yearlyChange As Double     Dim percentChange As Double     Dim LR As Double     Dim summary_table_row As Integer     Dim ws As Worksheet    'Bonus    Dim j As Integer    Dim volticker As String    Dim maxtic As String    Dim mintic As String    Dim maxvol As Double    Dim maxperc As Double    Dim minperc As Double        For Each ws In ThisWorkbook.Worksheets                ' init total volume            total_volume = 0            'for understanding last row            LR = ws.Cells(Rows.Count, 1).End(xlUp).Row            'keep track of sum table            summary_table_row = 2            openingPrice = ws.Cells(2, 3).Value                          'Loop through all stocks            For i = 2 To LR                             ' Set the Stock Name                     stockName = ws.Cells(i, 1).Value                                          ' Check if we are still within the same ticker, if we are not...                    If (stockName <> ws.Cells(i + 1, 1).Value) Then                      'Add to the total volume                     total_volume = total_volume + ws.Cells(i, 7).Value                                          'by definition this is the last row of stock                    closingPrice = ws.Cells(i, 6).Value                    yearlyChange = closingPrice - openingPrice                    percentChange = yearlyChange / openingPrice                                        'write out to summary table                     ws.Cells(summary_table_row, 9).Value = stockName                     ws.Cells(summary_table_row, 10).Value = yearlyChange                     ws.Cells(summary_table_row, 11).Value = percentChange                     ws.Cells(summary_table_row, 12).Value = total_volume                                           'Color Formatting                     If (yearlyChange > 0) Then                            ws.Cells(summary_table_row, 10).Interior.ColorIndex = 4                            Else                                    ws.Cells(summary_table_row, 10).Interior.ColorIndex = 3                            End If                                             'resets                        total_volume = 0                        summary_table_row = summary_table_row + 1                                                'look ahead                        openingPrice = ws.Cells(i + 1, 3).Value                    Else                         'Add to the volume                         total_volume = total_volume + ws.Cells(i, 7).Value                                         End If                          Next i            'Bonus                        maxvol = 0            maxperc = -999999999            minperc = 999999999                        For j = 2 To summary_table_row - 1                                If ws.Cells(j, 12).Value > maxvol Then                        maxvol = ws.Cells(j, 12).Value                        volticker = ws.Cells(j, 9).Value                    End If                                        If ws.Cells(j, 11).Value > maxperc Then                        maxperc = ws.Cells(j, 11).Value                        maxtic = ws.Cells(j, 9).Value                    End If                                        If ws.Cells(j, 11).Value < minperc Then                        minperc = ws.Cells(j, 11).Value                        mintic = ws.Cells(j, 9).Value                    End If            Next j                        ws.Range("R2").Value = maxtic            ws.Range("S2").Value = maxperc            ws.Range("R3").Value = mintic            ws.Range("S3").Value = minperc            ws.Range("R4").Value = volticker            ws.Range("S4").Value = maxvol            Next wsEnd Sub